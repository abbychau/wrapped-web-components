!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).WebComponentWrapper={})}(this,(function(t){"use strict";class e extends HTMLElement{constructor(){super(),!1!==this.constructor.useShadow&&this.attachShadow({mode:"open"}),this._props={},this._initialize()}_initialize(){this.constructor.styles&&this._applyStyles(),this.constructor.template&&this._applyTemplate(),"function"==typeof this.init&&this.init()}_applyStyles(){const t=this.constructor.styles;if(this.shadowRoot){const e=document.createElement("style");e.textContent=t,this.shadowRoot.appendChild(e)}else{const e=document.createElement("style"),r=`data-${this.tagName.toLowerCase()}-${Math.random().toString(36).substring(2,8)}`;this.setAttribute(r,"");const n=t.replace(/([^{]*){/g,((t,e)=>{if(e.trim().startsWith("@"))return t;return`${e.split(",").map((t=>`[${r}] ${t.trim()}`)).join(", ")} {`}));e.textContent=n,document.head.appendChild(e)}}_applyTemplate(){const t=this.constructor.template,e=this.shadowRoot||this;e.innerHTML="function"==typeof t?t.call(this):t,this._processEventBindings(e)}_processEventBindings(t){const e=t.querySelectorAll("*");Array.from(e).forEach((t=>{Array.from(t.attributes).filter((t=>t.name.startsWith("data-event-"))).forEach((e=>{const r=e.name.replace("data-event-",""),n=e.value;"function"==typeof this[n]?t.addEventListener(r,this[n].bind(this)):console.warn(`Handler "${n}" not found for event "${r}"`),t.removeAttribute(e.name)}))}))}connectedCallback(){"function"==typeof this.connected&&this.connected()}disconnectedCallback(){"function"==typeof this.disconnected&&this.disconnected()}attributeChangedCallback(t,e,r){if(e!==r){this[t.replace(/-([a-z])/g,((t,e)=>e.toUpperCase()))]=this._parseAttributeValue(r),"function"==typeof this.attributeChanged&&this.attributeChanged(t,e,r)}}_parseAttributeValue(t){if(null==t)return t;try{return JSON.parse(t)}catch(e){return t}}update(t={}){Object.entries(t).forEach((([t,e])=>{this[t]=e})),this.constructor.template&&this._applyTemplate()}}function r(t,...e){return t.reduce(((t,r,n)=>{const o=e[n]||"";let s;return s=null==o?"":"object"==typeof o&&o.isEventBinding?`data-event-${o.eventName}="${o.handlerName}"`:Array.isArray(o)?o.join(""):String(o).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),t+r+s}),"")}async function n(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load component from ${t}: ${e.statusText}`);return o(await e.text())}catch(t){throw console.error(`Error loading component: ${t.message}`),t}}function o(t){const e=(new DOMParser).parseFromString(t,"text/html"),r=e.querySelector("template"),n=r?r.innerHTML.trim():"",o=e.querySelector("style"),s=o?o.textContent.trim():"",i=e.querySelector("script");let a={};if(i)try{const t=i.textContent.trim();a=new Function("exports",`\n        const module = { exports: {} };\n        const exportObj = {};\n        \n        // Define export default\n        function exportDefault(obj) {\n          Object.assign(exportObj, obj);\n        }\n        \n        // Execute the script\n        ${t}\n        \n        // Return the exported object\n        return exportObj;\n      `)()}catch(t){console.error(`Error parsing script: ${t.message}`)}const c=e.body.firstElementChild,p={};return c&&Array.from(c.attributes).forEach((t=>{if(t.name.startsWith("data-")){const e=t.name.replace("data-","").replace(/-([a-z])/g,((t,e)=>e.toUpperCase()));p[e]=t.value}})),{template:n,style:s,script:a,attributes:p}}r.event=function(t,e){return{isEventBinding:!0,eventName:t,handlerName:e}};const s=new Map;function i(t,r){class n extends e{}return n.template=r.template||"",n.styles=r.style||"",n.useShadow=!1!==r.script?.useShadow,n.observedAttributes=r.script?.observedAttributes||[],r.script?.methods&&Object.entries(r.script.methods).forEach((([t,e])=>{n.prototype[t]=e})),["init","connected","disconnected","attributeChanged","propertyChanged"].forEach((t=>{"function"==typeof r.script?.[t]&&(n.prototype[t]=r.script[t])})),r.script?.properties&&Object.entries(r.script.properties).forEach((([t,e])=>{if(Object.defineProperty(n.prototype,t,{get(){return void 0!==this._props[t]?this._props[t]:e.default},set(r){const n=this._props[t];if(this._props[t]=r,e.reflect){const e=t.replace(/([A-Z])/g,"-$1").toLowerCase();null==r?this.removeAttribute(e):"boolean"==typeof r?r?this.setAttribute(e,""):this.removeAttribute(e):this.setAttribute(e,r)}"function"==typeof this.propertyChanged&&n!==r&&this.propertyChanged(t,n,r)},configurable:!0,enumerable:!0}),e.reflect&&!n.observedAttributes.includes(t)){const e=t.replace(/([A-Z])/g,"-$1").toLowerCase();n.observedAttributes.push(e)}})),customElements.define(t,n),s.set(t,n),n}t.Component=e,t.css=function(t,...e){return t.reduce(((t,r,n)=>t+r+(e[n]||"")),"")},t.define=function(t,r={}){class n extends e{}return n.template=r.template||"",n.styles=r.styles||"",n.useShadow=!1!==r.useShadow,n.observedAttributes=r.observedAttributes||[],r.methods&&Object.entries(r.methods).forEach((([t,e])=>{n.prototype[t]=e})),r.properties&&Object.entries(r.properties).forEach((([t,e])=>{if(Object.defineProperty(n.prototype,t,{get(){return void 0!==this._props[t]?this._props[t]:e.default},set(r){const n=this._props[t];if(this._props[t]=r,e.reflect){const e=t.replace(/([A-Z])/g,"-$1").toLowerCase();null==r?this.removeAttribute(e):"boolean"==typeof r?r?this.setAttribute(e,""):this.removeAttribute(e):this.setAttribute(e,r)}"function"==typeof this.propertyChanged&&n!==r&&this.propertyChanged(t,n,r)},configurable:!0,enumerable:!0}),e.reflect&&!n.observedAttributes.includes(t)){const e=t.replace(/([A-Z])/g,"-$1").toLowerCase();n.observedAttributes.push(e)}})),customElements.define(t,n),n},t.getComponent=function(t){return s.get(t)},t.hasComponent=function(t){return s.has(t)},t.html=r,t.loadComponent=n,t.parseComponent=o,t.register=async function(t,e){if("string"!=typeof e)return i(t,e);try{return i(t,await n(e))}catch(e){throw console.error(`Failed to register component ${t}: ${e.message}`),e}}}));
